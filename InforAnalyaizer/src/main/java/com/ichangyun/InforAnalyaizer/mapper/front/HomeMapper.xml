<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ichangyun.InforAnalyaizer.mapper.front.HomeMapper">
	
	<select id="getHotWord" resultType="com.ichangyun.InforAnalyaizer.model.front.HotWordBean">
	  
	      select * from a_hotwordsbasicinfo ORDER BY UpdateDateTime desc LIMIT 0,20
	
	</select>
	
	
	<select id="getArticleCountByHotWord" parameterType="com.ichangyun.InforAnalyaizer.model.front.HotWordBean" resultType="java.lang.Integer">
	      select count(1) from a_articlebasicinfo where ArticleKeyWord  like CONCAT('%',#{HotWord},'%')
	</select>
	
	
	<select id="getArticleByHotWord" parameterType="com.ichangyun.InforAnalyaizer.model.front.HotWordBean" resultType="com.ichangyun.InforAnalyaizer.model.thematicmonitoring.ArticleInfoBean">
	      select a.*,
            (select m.WebsiteName from m_websiteinfo m where m.Website_ID = a.Website_ID) WebsiteName,
            (select count(1) from a_articlebasicinfo b where a.SimilarArticlesNo=b.SimilarArticlesNo and a.Article_ID!=b.Article_ID) sim_cnt,
            (select count(1) from m_mycollection c where c.Article_ID=a.Article_ID ) collcnt,
            (select count(1) from a_userearlywarningarticleinfo d where  d.Article_ID=a.Article_ID and  d.User_ID=#{CreateUser}) yj_cnt
            from a_articlebasicinfo a where a.ArticleKeyWord like CONCAT('%',#{HotWord},'%')
            ORDER BY UpdateDateTime desc
          limit #{l_pre},#{rowSize}
	</select>
	
	<select id="getSimContent" parameterType="com.ichangyun.InforAnalyaizer.model.thematicmonitoring.ArticleInfoBean" resultType="com.ichangyun.InforAnalyaizer.model.thematicmonitoring.ArticleInfoBean">
	      select a.Article_ID,a.ArticleTitle,a.ArticleURL from a_articlebasicinfo a where a.SimilarArticlesNo=
			(select b.SimilarArticlesNo from a_articlebasicinfo b where b.Article_ID=#{Article_ID}) and a.Article_ID!=#{Article_ID}
	      order by Releasetime desc 
	</select>
	
	<select id="getNewestDatas" resultType="com.ichangyun.InforAnalyaizer.model.thematicmonitoring.ArticleInfoBean">
	     select a.Article_ID,a.ArticleTitle from a_articlebasicinfo a
	     where not exists 
	     (select 1 from a_userdeletearticleinfo b where b.Article_ID=a.Article_ID)
	      ORDER BY a.Releasetime desc limit 0,10
	</select>
	
	<select id="getWarnDatas" parameterType="java.lang.String" resultType="com.ichangyun.InforAnalyaizer.model.thematicmonitoring.ArticleInfoBean">
	    select distinct a.Article_ID,a.ArticleTitle from a_articlebasicinfo a,a_userearlywarningarticleinfo b
	     where a.Article_ID = b.Article_ID and b.User_ID=#{userid}
	     and not exists 
	     (select 1 from a_userdeletearticleinfo c where c.Article_ID=a.Article_ID)
			ORDER BY a.Releasetime desc limit 0,10
	</select>
	
	<select id="getNegativeDatas" resultType="com.ichangyun.InforAnalyaizer.model.thematicmonitoring.ArticleInfoBean">
	    select a.Article_ID,a.ArticleTitle from a_articlebasicinfo a where a.EmotionDivision='2' 
	    and not exists 
	     (select 1 from a_userdeletearticleinfo b where b.Article_ID=a.Article_ID)
	    ORDER BY a.Releasetime desc limit 0,10
	</select>
	
	<select id="getJCMsg" resultType="java.util.Map">
	   SELECT

	    (SELECT count(1) from a_articlebasicinfo where DATE_FORMAT(Releasetime,'%Y/%m/%d')=#{today}) t_total,
	
	    (select count(1) from a_articlebasicinfo a,a_articleplaninfo b,m_planinfo c where DATE_FORMAT(a.Releasetime,'%Y/%m/%d')=#{today}
	                  and a.Article_ID=b.Article_ID and b.Plan_ID=c.Plan_ID and c.User_ID=#{userid}
	     ) t_ztjc,
	
	     (SELECT count(1) from a_articlebasicinfo where DATE_FORMAT(Releasetime,'%Y/%m/%d')=#{today} and EmotionDivision='2' ) t_fmxx,
	
	     (select count(1) from A_UserEarlyWarningArticleInfo a ,a_articlebasicinfo b where a.Article_ID = b.Article_ID and a.User_ID=#{userid} 
		
		and DATE_FORMAT(b.Releasetime,'%Y/%m/%d')=#{today}) t_yjxx,
	
	  (SELECT count(1) from a_articlebasicinfo where DATE_FORMAT(Releasetime,'%Y/%m/%d')=#{yesterday}) y_total,
	
	    (select count(1) from a_articlebasicinfo a,a_articleplaninfo b,m_planinfo c where DATE_FORMAT(a.Releasetime,'%Y/%m/%d')=#{yesterday}
	                  and a.Article_ID=b.Article_ID and b.Plan_ID=c.Plan_ID and c.User_ID=#{userid}
	     ) y_ztjc,
	
	     (SELECT count(1) from a_articlebasicinfo where DATE_FORMAT(Releasetime,'%Y/%m/%d')=#{yesterday} and EmotionDivision='2' ) y_fmxx,
	
	     (select count(1) from A_UserEarlyWarningArticleInfo a ,a_articlebasicinfo b where a.Article_ID = b.Article_ID and a.User_ID=#{userid} 
		
		and DATE_FORMAT(b.Releasetime,'%Y/%m/%d')=#{yesterday}) y_yjxx
	</select>
	
</mapper>